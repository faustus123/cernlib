CDECK  ID>, QPOSTM.
      SUBROUTINE QPOSTM (DUMPC)

C--                POST-MORTEM OF HYDRA SYSTEM

      PARAMETER      (NQFNAE=2, NQFNAD=1, NQFNAU=3)
      PARAMETER      (IQFSTR=19, NQFSTR=6,  IQFSYS=25, NQFSYS=8)
      COMMON /MQCF/  NQNAME,NQNAMD,NQNAMU, IQSTRU,NQSTRU, IQSYSB,NQSYSB
      COMMON /MQCMOV/NQSYSS
      COMMON /MQCM/         NQSYSR,NQSYSL,NQLINK,LQWORG,LQWORK,LQTOL
     +,              LQSTA,LQEND,LQFIX,NQMAX, NQRESV,NQMEM,LQADR,LQADR2
      COMMON /MQCT/  IQTBIT,IQTVAL,LQTA,LQTB,LQTE,LQMTB,LQMTE,LQMTH
     +,              IQPART,NQFREE
      COMMON /QBCD/  IQNUM2(11),IQLETT(26),IQNUM(10),IQPLUS
     +,              IQMINS,IQSTAR,IQSLAS,IQOPEN,IQCLOS,IQDOLL,IQEQU
     +,              IQBLAN,IQCOMA,IQDOT,IQAPO,  IQCROS
      COMMON /QCN/   IQLS,IQID,IQNL,IQNS,IQND,IQFOUL
      PARAMETER      (IQBITW=32, IQBITC=8, IQCHAW=4)
      COMMON /QMACH/ NQBITW,NQCHAW,NQLNOR,NQLMAX,NQLPTH,NQRMAX,QLPCT
     +,              NQOCT(3),NQHEX(3),NQOCTD(3)
      COMMON /QSTATE/QVERSN,NQINIT,NQSTAG(2),NQPHAS,NQERR,QDEBUG,NQDCUT
     +,              NQNEWB,NQAFTB,NQM99,NQLOWB,NQWCUT,NQLOCK,QSTDUM
     +,              NQAUGM(2),NQZIP(8),AQMEM(12)
                         INTEGER QDEBUG
      COMMON /QUNIT/ IQREAD,IQPRNT,IQPR2,IQLOG,IQPNCH,IQTTIN,IQTYPE
     +,              IQDLUN,IQFLUN,IQHLUN,IQCLUN,  NQUSED
      COMMON /QHEADP/IQHEAD(20),IQDATE,IQTIME,IQPAGE,NQPAGE(4)
      PARAMETER      (IQBDRO=25, IQBMAR=26, IQBCRI=27, IQBSYS=31)
      COMMON /QBITS/ IQDROP,IQMARK,IQCRIT,IQZIM,IQZIP,IQSYS
                         DIMENSION    IQUEST(30)
                         DIMENSION                 LQ(99), IQ(99), Q(99)
                         EQUIVALENCE (QUEST,IQUEST),    (LQUSER,LQ,IQ,Q)
      COMMON /SQK/   KQMAIN,KQT,KQR,KQJ,KQF,KQZ,KQH(4),KQS(8)
      COMMON //      QUEST(30),LQUSER(7),LQMAIN,LQT,LQR,LQJ,LQF,LQZ
     +,              LQH(4),LQS(6),   LQWM,LQWF,LQWZ,LQWSYS(6),LQPRIV(7)
     +,              LQ1,LQ2,LQ3,LQ4,LQ5,LQ6,LQ7,LQSV,LQAN,LQDW,LQUP
C--------------    END CDE                             -----------------  ------
      DIMENSION    IVMQCM(14), IVQCN(5), DUMPC(9)
      EQUIVALENCE (IVMQCM(1),NQSYSR), (IVQCN(1),IQLS)


      WRITE (IQLOG,9010)  IVMQCM
      WRITE (IQLOG,9011)  IVMQCM
      WRITE (IQLOG,9020)
      WRITE (IQLOG,9011)  (LQ(J),J=1,70)
      WRITE (IQLOG,9021)  IQUEST
      WRITE (IQLOG,9011)  IQUEST
      WRITE (IQLOG,9025)  IVQCN
      WRITE (IQLOG,9011)  IVQCN

C     NO TRACE BACK NEEDED IN PRODUCTION
      IQDLUN= IQLOG
CAV   The routine below does not exist
CAV      CALL DQSNAP (6HQPOSTM,DUMPC)

      IF (NQERR.LT.100)  RETURN
      CALL MQEND
      CALL ABEND

 9010 FORMAT (84H1HYDRA SYSTEM POST-MORTEM FROM QPOSTM.      STRAIGHT DU
     FMP OF CRITICAL CONTROL AREAS./106H0COMMON /MQCM/NQSYSR,NQSYSL,NQLI
     FNK,LQWORG,LQWORK, LQTOL,LQSTA,LQEND,LQFIX,NQMAX,NQRESV,NQMEM,LQADR
     F,LQADR2 /(2X,5I21))
C9011 FORMAT (2X,5O21)                                                  OCT
 9011 FORMAT (2X,5Z21)                                                  HEX
 9020 FORMAT (22H BEGINNING OF VECTOR Q)
 9021 FORMAT (6H QUEST /(2X,5I21))
 9025 FORMAT (27H COMMON /QCN/LS,ID,NL,NS,ND/2X,I21,A21,3I21)
      END
