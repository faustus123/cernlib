CDECK  ID>, PEND.
      SUBROUTINE PEND

C-    PRINT FINAL SUMMARY, REWIND USED ASM-FILES

      COMMON /MQCMOV/NQSYSS
      COMMON /MQCM/         NQSYSR,NQSYSL,NQLINK,LQWORG,LQWORK,LQTOL
     +,              LQSTA,LQEND,LQFIX,NQMAX, NQRESV,NQMEM,LQADR,LQADR2
      COMMON /QBCD/  IQNUM2(11),IQLETT(26),IQNUM(10),IQPLUS
     +,              IQMINS,IQSTAR,IQSLAS,IQOPEN,IQCLOS,IQDOLL,IQEQU
     +,              IQBLAN,IQCOMA,IQDOT,IQAPO,  IQCROS
      PARAMETER      (IQBITW=32, IQBITC=8, IQCHAW=4)
      COMMON /QMACH/ NQBITW,NQCHAW,NQLNOR,NQLMAX,NQLPTH,NQRMAX,QLPCT
     +,              NQOCT(3),NQHEX(3),NQOCTD(3)
      COMMON /QUNIT/ IQREAD,IQPRNT,IQPR2,IQLOG,IQPNCH,IQTTIN,IQTYPE
     +,              IQDLUN,IQFLUN,IQHLUN,IQCLUN,  NQUSED
      COMMON /IOFCOM/IOTALL,IOTOFF,IOTON,IOSPEC,IOPARF(5),IOMODE(12)
      PARAMETER      (IQBDRO=25, IQBMAR=26, IQBCRI=27, IQBSYS=31)
      COMMON /QBITS/ IQDROP,IQMARK,IQCRIT,IQZIM,IQZIP,IQSYS
                         DIMENSION    IQUEST(30)
                         DIMENSION                 LQ(99), IQ(99), Q(99)
                         EQUIVALENCE (QUEST,IQUEST),    (LQUSER,LQ,IQ,Q)
      COMMON //      QUEST(30),LQUSER(7),LQMAIN,LQSYS(24),LQPRIV(7)
     +,              LQ1,LQ2,LQ3,LQ4,LQ5,LQ6,LQ7,LQSV,LQAN,LQDW,LQUP
     +, KADRV(9), LEXD,LEXH,LEXP,LPAM,LDECO, LADRV(14)
     +, NVOPER(6),MOPTIO(31),JANSW,JCARD,NDECKR,NVUSEB(14),MEXDEC(6)
     +, NVINC(6),NVUTY(16),NVIMAT(6),NVACT(6),NVGARB(6),NVWARN(6)
     +, NVARRQ(6),NVARR(10),IDARRV(10),NVARRI(12),NVCCP(10)
     +, NVDEP(19),MDEPAR,NVDEPL(6),  MWK(80),MWKX(80)
      EQUIVALENCE(LPAST,LADRV(1)),  (LPCRA,LADRV(2)), (LDCRAB,LADRV(3))
     +,          (LSASM,LADRV(8)),  (LRBIG,LADRV(13)), (LRPAM,LADRV(14))
C--------------    END CDE                             -----------------  ------
      DIMENSION    MASMPR(11), MFILPN(9), MFILPR(11), NVGBPR(4)
      EQUIVALENCE (MASMPR(3),  MFILPN(1), MFILPR(1),IQUEST(8))
      EQUIVALENCE (NVGBPR(1),NVGARB(1))

      DIMENSION    LISTPR(57),LISBIT(40),LISPAT(8)
      EQUIVALENCE (LISTPR(10),LISBIT(1),MWKX(10))
     +,           (LISTPR(50),LISPAT(1))

      DIMENSION    IVNQL(3)
      EQUIVALENCE (IVNQL(1),NQLNOR)


C------            PRINT SUMMARY OF PATCHES

      IF (NQUSED.GE.16)  WRITE (IQPRNT,9008)
      IF (NQUSED.LT.16)  WRITE (IQPRNT,9009)
      WRITE (IQPRNT,9010)
      IQ(LPAST-1) = LQUSER(7)
      CALL QTOPSY (KADRV(8))
      JBITQ = -1
      L = LEXP

   11 IF (IQ(L+2).EQ.IQDOT)  GO TO 14
      NVUSEB(10) = IQ(L)
      NVUSEB(11) = IQ(L+1)
      IF (JBITQ.LT.0)                   GO TO 12
      IF (JBIT(NVUSEB(11),6).EQ.JBITQ)  GO TO 12
      NOTHER = 7
      GO TO 17

   12 LISTPR(1) = JBYT (NVUSEB(11),16,15)
      CALL UBLOW (IQ(L+2),LISTPR(2),8)

      MMM = 63 - JBYT(NVUSEB(10),6,5)
      CALL CBYT (NVUSEB(10), 1,MMM, 6, 5)
      CALL CBYT (NVUSEB(10),11,MMM,11, 8)
      CALL CBYT (NVUSEB(11), 1,MMM,19, 7)
C-                  ----+----1----+----2----+----3----+----4----+---
      CALL UCTOH1 ('DMELU . DMELU . DMEL . DMEL . FMXPRQ* .         '
     +,                      LISBIT(1),48)
      CALL UPKBYT (MMM,1,MWK(1),26,0)
      IF (MWK(17).NE.0)  MWK(21)=0
      JB = 1

      DO 13 J=1,37
      IF (LISBIT(J).EQ.IQDOT)   GO TO 13
      IF (LISBIT(J).EQ.IQBLAN)  GO TO 13
      IF (MWK(JB).EQ.0)  LISBIT(J)=IQBLAN
      JB = JB + 1
   13 CONTINUE

      J = IQ(L-3)
      IF (J.NE.0)  CALL UBLOW (IQ(J+2),LISPAT(1),8)
      WRITE (IQPRNT,9013) LISTPR
      GO TO 17

C--                RPAM-BANK, NEW PAM-FILE

   14 CALL UBLOW (IQ(L+4),MFILPR(1),8)
      MFILPR(9) = JBYT (IQ(L),1,17)                                     -MSK
C     MFILPR(9) = IQ(L) .AND. 131071                                     MSKC
      MFILPR(10)= IQ(L+1)
      MFILPR(11)= IQ(L+3)
      IF (MFILPR(10).LT.0)   GO TO 16
      WRITE (IQPRNT,9014) MFILPR
      GO TO 17

   16 WRITE (IQPRNT,9016) MFILPN
   17 L = IQ(L-1)
      IF (L.EQ.0)            GO TO 18
      IF (L.NE.LPAST)        GO TO 11
      IF (IQ(L-1).EQ.0)      GO TO 21
C     CALL QSORTH (2,  LPAST-1)                                          A8M
      CALL QSORVH (2,2,LPAST-1)                                         -A8M
      WRITE (IQPRNT,9018)
      NOTHER = 0
      JBITQ  = 1
      GO TO 17

   18 IF (JBITQ.EQ.0)        GO TO 21
      IF (NOTHER.EQ.0)       GO TO 21
      WRITE (IQPRNT,9019)
      JBITQ = 0
      L = LPAST
      GO TO 17

C----              PRINT SUMMARY OF PAM MATERIAL READ

   21 WRITE (IQPRNT,9021)  (IQ(J+LPAM),J=7,11)

C----              IDENTIFY ALL ACTIVE ASM STREAMS

      DO 27  JF=1,10
      LASM = IQ(LSASM-JF)
      IF (IQ(LASM+5).EQ.0)   GO TO 27
      NCASM = IQ(LASM+2)
      IF (NCASM)             26,27,24

   24 JM = IQ(LASM+1)
      IF (JM.EQ.JF)          GO TO 27
      LASMM = IQ(LSASM-JM)
      IF (IQ(LASMM+3).NE.0)  GO TO 27
      IQ(LASMM+3) = -1
      GO TO 27

   26 IQ(LASM+2) = 0
   27 CONTINUE

C----              PRINT ASM SUMMARY, REWIND USED ASM FILES

      WRITE (IQPRNT,9031)
      MACTIV = 0

      DO 39 JF=1,10
      LASM  = IQ(LSASM-JF)
      IF (IQ(LASM+5).EQ.0)   GO TO 39

      CALL VBLANK (IQUEST(11),7)
      JM    = IQ(LASM+1)
      LASMM = IQ(LSASM-JM)
      NCASM = IQ(LASM+2)

C--                SECONDARY STREAM

      IF (JF.EQ.JM)          GO TO 31
      IF (NCASM.EQ.0)        GO TO 39
      GO TO 37

C--                PRIMARY STREAM

   31 NDKASM = IQ(LASM+3)

      IF (NDKASM.EQ.0)       GO TO 37

   36 CALL IOFILE (580,IQ(LASMM+5))
C-                 580 =   4 CARDS, 64 OUTPUT, 512 FINAL

   37 MASMPR(1) = IQ(LASM+4)
      MASMPR(2) = NCASM
      MASMPR(3) = IQ(LASM+3)
      MASMPR(4) = IQ(LASMM+10)
      MASMPR(5) = IQBLAN
      WRITE (IQPRNT,9038) MASMPR
   39 CONTINUE

C----              PRINT STORE INFORMATION

      NVGBPR(1) = NQMAX
      WRITE (IQPRNT,9041)  NVGBPR
      IF (NVGARB(4).NE.0)    GO TO 44
      J = LQTOL - LQWORK - NVGARB(3)
      WRITE (IQPRNT,9042) J
   44 CONTINUE

C----              PRINT LINES PARAMETERS

      WRITE (IQPRNT,9047) IVNQL

C----              PRINT WARNINGS

      WRITE (IQPRNT,9051) NVWARN

      N = NVWARN(1)+NVWARN(2)+NVWARN(3)+NVWARN(4)+NVWARN(6)
      IF (N.NE.0)   WRITE (IQPRNT,9052)

      RETURN

 9008 FORMAT (1H1,38(1H-))
 9009 FORMAT (1X/1X,38(1H-))
 9010 FORMAT (39H SUMMARY OF PATCHES IN PROCESSING ORDER/1X/
     F' PROCESSING MODE SELECTIONS',24X,'OTHER STATUS BITS FOR P=X'/1X/
     F11H D - DIVERT,40X,'F  - - -  DESELECTED BY  +PATCH,P=X,IF=...'/
     F 8H M - MIX,44X,'M - - -  DESELECTED BY  +IMITATE,P=X'/
     F 8H E - EXE,45X,'X  - -  NOT +EXE BUT AT LEAST 1 DECK TO ASM'/
     F 9H L - LIST,45X,'P - -  PARTIAL USE-SELECTION BY +USE,P=X,D=...'/
     F 8H U - USE,20X,6HSELF +,9X,4HSELF,8X,'R  -  P=X,T=REPEAT' /
     F20X,'INHIBIT FOREIGN  TRANS   ONLY',7X,'Q -  QUOTED IN IF=X'/
     F19X,2(8H -------),2(7H ------) /
     F19X,2(8H  DMELU ),2(7H  DMEL ),'  FMXPRQ    USED FROM P='/1X)
 9013 FORMAT (3X,I6,1X,8A1,3H . ,60A1)
 9014 FORMAT (1X,8A1,52X,'PAM  CALL/FILE',I5/3X,I6,2H -,I6)
 9016 FORMAT (1X,8A1,4H ---,48X,'PAM  CALL/FILE',I5)
 9018 FORMAT (1X/1X,28(1H-)/29H QUOTED PATCHES NOT TURNED UP/1X)
 9019 FORMAT (1X/1X,28(1H-)/29H OTHER  PATCHES NOT TURNED UP/1X)
 9021 FORMAT (1X/1X,14(1H-)/8H READ   ,I7,18H CARDS   ON CRADLE/
     F8X,I7,21H CARDS   ON CARD-PAMS/
     F8X,I7,' RECORDS ON COMPACT BINARY PAMS, INCL.',I6,' SKIPPED.'/
     F8X,I7,11H PAM-CALLS.)
 9031 FORMAT (1X/1X,14(1H-)/8H WRITTEN)
 9038 FORMAT (8X,3HASM,A2,I7,6H CARDS,I6,15H DECKS TO  LUN=,I3,A2,
     F4H -- ,7A1)
 9041 FORMAT (1X/1X,12(1H-)/13H MEMORY USAGE/
     F22H FINAL SIZE OF STORE =,I7/
     F39H LARGEST GAP REQUIRED BY ANY DECK WAS =,I5/
     F30H GAP SECURITY FOR THIS RUN WAS,8X,1H=,I5/
     F32H NUMBER OF GARBAGE COLLECTIONS =,I4)
 9042 FORMAT (25H NUMBER OF WORDS UNUSED =,I6)
 9047 FORMAT (1X/1X,17(1H-)/' LINES IN  /QMACH/'/' NQL-NOR  MAX  PTH'/
     F3X,3I5)
 9051 FORMAT (1X/1X,22(1H-)/23H NO.OF WARNINGS PRINTED/
     F1X/18H BAD CONTROL CARDS,I5/18H MISSING SEQUENCES,I5/
     F18H LOST ACTIVATIONS ,I5/16H UNSATISF/ REF'S,I7/
     F16H LEVEL 1 CLASHES,  I7/16H LEVEL 2 CLASHES,I7/1X,22(1H-))
 9052 FORMAT (1X,3(/1X,44(1H*)))
      END
