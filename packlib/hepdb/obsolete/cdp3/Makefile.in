#
# hepdb/cdp3/Makefile.in - compiles and archives the source code in this directory.
# It is invoked by Makefile.xxxxx in the above directory, where xxxxx is the name of the library.
# Generated by car2cvs $Revision$ (nk)
#
# $Id$
#
# $Log$
# Revision 1.1  1996/02/28 16:24:06  mclareni
# Initial revision
#
#

MAKE = gmake
SHELL = /bin/sh
srcdir = @srcdir@
VPATH = @srcdir@
MACHINE = @MACHINE@

CPP = @CPP@
ETAGS = etags -a
MAKEDEPEND = @MAKEDEPEND@
FC = @FC@
FFLAGS = @FFLAGS@
OPT_FFLAGS = @OPT_FFLAGS@
DBG_FFLAGS = @DBG_FFLAGS@
ifeq "$(srcdir)" "."
  absrcdir = $(shell pwd)
else
  absrcdir = $(srcdir)
endif

FORTRAN_SOURCES=$(wildcard $(srcdir)/*.F)

NOTDIR_F_SOURCES=$(notdir $(FORTRAN_SOURCES))

OBJS=$(NOTDIR_F_SOURCES:%.F=$(LIBRARY)(%.o))

VAX_FORTRAN_SOURCES=$(NOTDIR_F_SOURCES:%.F=$(LOCALVAXSRC)/%.for)

VAX_COMS := $(NOTDIR_F_SOURCES:.F=.com)

LIBRARY=dummy
ifeq "$(LIBRARY)" "dummy"
  OBJS=
endif
.SUFFIXES: .cdf

.PHONY:dummy production vaxsrc vaxcom debug clean distclean realclean TAGS depend fort_depend c_depend cc_depend
	@

dummy::
	@echo Run Makefile in the parent directory

debug production:$(OBJS)
	@test "$(LIBRARY)" = "dummy" || test "`echo *.o`" = "*.o" || ($(AR) rvs $(LIBRARY) *.o;$(RM) *.o)

vaxsrc:$(VAX_FORTRAN_SOURCES)
	@ 

vaxcom:$(VAX_COMS)
	@ 

clean:
	@rm -f *.o *.bak

distclean:clean
	@rm -f Makefile Makefile.obj

realclean:
	@rm -f *~ #*

TAGS:$(absrcdir)/*[Fch]
	@$(ETAGS) -f $(dir $(LIBRARY))/TAGS.$(LIBRARY_NAME) $(absrcdir)/*[Fch]

depend:fort_depend 
	@test "$(LIBRARY)" != "dummy" || echo Run Makefile in the parent directory

.F.a:
	$(FC) $(CERNLIB_DEFS) $(CERNLIB_FFLAGS) $(FFLAGS) -c $<


$(LOCALVAXSRC)/%.for:%.F ; $(CPP) -DCERNLIB_VAX $(CERNLIB_DEFS) $(CERNLIB_FFLAGS) $(FFLAGS) $< | grep -v "^\#" > $@
	@

%.com:%.F ; @echo "$$ @cernlib_cfl $* $(shell basename $(srcdir)) $(shell basename $(shell dirname $(srcdir))) $(LIBRARY_NAME) $(CERNLIB_DEFS)" >> $(LOCALVAXSRC)/cfl.com
	@

fort_depend:$(FORTRAN_SOURCES)
	@test "$(LIBRARY)" = "dummy" || test -z "$(FORTRAN_SOURCES)" || $(MAKEDEPEND) -o.o\) -p$$\(LIBRARY\)\( $(CERNLIB_DEFS) $(CERNLIB_FFLAGS) $(FORTRAN_SOURCES)




