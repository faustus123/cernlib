#include "isajet/pilot.h"
      REAL*8 FUNCTION ZJJ7(P1, P2, P3, P4, P5,NHEL,IM1)
C  
C FUNCTION GENERATED BY MADGRAPH
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT IN PHASE SPACE P1,P2,P3,P4,...
C AND HELICITY NHEL(1),NHEL(2),....
C  
C FOR PROCESS : g u  -> z g u  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS,    NEIGEN,    NEXTERNAL       
      PARAMETER (NGRAPHS=  8,NEIGEN=  2,NEXTERNAL=5)    
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 P1(0:3),P2(0:3),P3(0:3),P4(0:3),P5(0:3)
      INTEGER NHEL(NEXTERNAL)
      INTEGER IM1
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J
      REAL*8 EIGEN_VAL(NEIGEN), EIGEN_VEC(NGRAPHS,NEIGEN)
      COMPLEX*16 ZTEMP
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W1(6)  , W2(6)  , W3(6)  , W4(6)  , W5(6)        
      COMPLEX*16 W6(6)  , W7(6)  , W8(6)  , W9(6)  , W10(6)       
      COMPLEX*16 W11(6) , W12(6) , W13(6) , W14(6) , W15(6) 
      REAL*8 GZUD(2)
C  
C GLOBAL VARIABLES
C  
#include "isajet/mgcoms.inc"
C  
C COLOR DATA
C  
      DATA EIGEN_VAL(1  )/       5.8333333333333270D-01 /                  
      DATA EIGEN_VEC(1  ,1  )/   4.0824829046386285D-01 /                  
      DATA EIGEN_VEC(2  ,1  )/   0.0000000000000000D+00 /                  
      DATA EIGEN_VEC(3  ,1  )/   4.0824829046386318D-01 /                  
      DATA EIGEN_VEC(4  ,1  )/   0.0000000000000000D+00 /                  
      DATA EIGEN_VEC(5  ,1  )/   4.0824829046386285D-01 /                  
      DATA EIGEN_VEC(6  ,1  )/   4.0824829046386285D-01 /                  
      DATA EIGEN_VEC(7  ,1  )/   4.0824829046386318D-01 /                  
      DATA EIGEN_VEC(8  ,1  )/   4.0824829046386318D-01 /                  
      DATA EIGEN_VAL(2  )/       1.7499999999999991D+00 /                  
      DATA EIGEN_VEC(1  ,2  )/   2.6726124191242445D-01 /                  
      DATA EIGEN_VEC(2  ,2  )/  -5.3452248382484879D-01 /                  
      DATA EIGEN_VEC(3  ,2  )/  -2.6726124191242434D-01 /                  
      DATA EIGEN_VEC(4  ,2  )/  -5.3452248382484879D-01 /                  
      DATA EIGEN_VEC(5  ,2  )/   2.6726124191242445D-01 /                  
      DATA EIGEN_VEC(6  ,2  )/   2.6726124191242445D-01 /                  
      DATA EIGEN_VEC(7  ,2  )/  -2.6726124191242434D-01 /                  
      DATA EIGEN_VEC(8  ,2  )/  -2.6726124191242434D-01 /                  
C ----------
C BEGIN CODE
C ----------
      IF(IM1.EQ.3.OR.IM1.EQ.7.OR.IM1.EQ.11) THEN
        GZUD(1)=GZD(1)
        GZUD(2)=GZD(2)
      ELSE
        GZUD(1)=GZU(1)
        GZUD(2)=GZU(2)
      ENDIF
C
      CALL VXXXXX(P1  , ZERO,NHEL(1  ),-1,W1  )                            
      CALL IXXXXX(P2  ,FMASS(IM1),NHEL(2  ), 1,W2  )                       
      CALL VXXXXX(P3  ,ZMASS,NHEL(3  ), 1,W3  )                            
      CALL VXXXXX(P4  , ZERO,NHEL(4  ), 1,W4  )                            
      CALL OXXXXX(P5  ,FMASS(IM1),NHEL(5  ), 1,W5  )                       
      CALL FVIXXX(W2  ,W3  ,GZUD,FMASS(IM1),FWIDTH(IM1),W6  )               
      CALL FVIXXX(W6  ,W4  ,GG,FMASS(IM1),FWIDTH(IM1),W7  )                
      CALL IOVXXX(W7  ,W5  ,W1  ,GG,AMP(1  ))                              
      CALL JGGXXX(W4  ,W1  ,G,W8  )                                        
      CALL FVOXXX(W5  ,W3  ,GZUD,FMASS(IM1),FWIDTH(IM1),W9  )               
      CALL IOVXXX(W2  ,W9  ,W8  ,GG,AMP(2  ))                              
      CALL FVIXXX(W6  ,W1  ,GG,FMASS(IM1),FWIDTH(IM1),W10 )                
      CALL IOVXXX(W10 ,W5  ,W4  ,GG,AMP(3  ))                              
      CALL IOVXXX(W6  ,W5  ,W8  ,GG,AMP(4  ))                              
      CALL FVIXXX(W2  ,W4  ,GG,FMASS(IM1),FWIDTH(IM1),W11 )                
      CALL FVOXXX(W5  ,W1  ,GG,FMASS(IM1),FWIDTH(IM1),W12 )                
      CALL IOVXXX(W11 ,W12 ,W3  ,GZUD,AMP(5  ))                             
      CALL IOVXXX(W11 ,W9  ,W1  ,GG,AMP(6  ))                              
      CALL FVIXXX(W2  ,W1  ,GG,FMASS(IM1),FWIDTH(IM1),W13 )                
      CALL FVIXXX(W13 ,W4  ,GG,FMASS(IM1),FWIDTH(IM1),W14 )                
      CALL IOVXXX(W14 ,W5  ,W3  ,GZUD,AMP(7  ))                             
      CALL FVIXXX(W13 ,W3  ,GZUD,FMASS(IM1),FWIDTH(IM1),W15 )               
      CALL IOVXXX(W15 ,W5  ,W4  ,GG,AMP(8  ))                              
      ZJJ7 = 0.D0 
      DO I = 1, NEIGEN
          ZTEMP = (0.D0,0.D0)
          DO J = 1, NGRAPHS
              ZTEMP = ZTEMP + EIGEN_VEC(J,I)*AMP(J)
          ENDDO
          ZJJ7 =ZJJ7+ZTEMP*EIGEN_VAL(I)*CONJG(ZTEMP) 
      ENDDO
C      CALL GAUGECHECK(AMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NGRAPHS,NEIGEN)
      END
