      SUBROUTINE TSTFLEM(IOFF)
C... fill histograms
#include "stdhep.inc"

      INTEGER IOFF,I

      CALL HFILL(IOFF+11,FLOAT(NEVHEP),0.,1.)
      CALL HFILL(IOFF+12,FLOAT(NHEP),0.,1.)
      DO 100 I=1,NHEP
        CALL HFILL(IOFF+13,FLOAT(IDHEP(I)),0.,1.)
        CALL HFILL(IOFF+14,FLOAT(ISTHEP(I)),0.,1.)
        CALL HFILL(IOFF+15,FLOAT(JMOHEP(1,I)),0.,1.)
        CALL HFILL(IOFF+16,FLOAT(JMOHEP(2,I)),0.,1.)
        CALL HFILL(IOFF+17,FLOAT(JDAHEP(1,I)),0.,1.)
        CALL HFILL(IOFF+18,FLOAT(JDAHEP(2,I)),0.,1.)
        CALL HFILL(IOFF+21,SNGL(PHEP(1,I)),0.,1.)
        CALL HFILL(IOFF+22,SNGL(PHEP(2,I)),0.,1.)
        CALL HFILL(IOFF+23,SNGL(PHEP(3,I)),0.,1.)
        CALL HFILL(IOFF+24,SNGL(PHEP(4,I)),0.,1.)
        CALL HFILL(IOFF+25,SNGL(PHEP(5,I)),0.,1.)
        CALL HFILL(IOFF+26,SNGL(VHEP(1,I)),0.,1.)
        CALL HFILL(IOFF+27,SNGL(VHEP(2,I)),0.,1.)
        CALL HFILL(IOFF+28,SNGL(VHEP(3,I)),0.,1.)
        CALL HFILL(IOFF+29,SNGL(VHEP(4,I)),0.,1.)
 100  CONTINUE
      RETURN
      END
      SUBROUTINE TSTFLXSEC(IOFF)
C... fill histograms
#include "stdhep.inc"
#include "stdcm1.inc"

      INTEGER IOFF
      REAL BN

      BN = FLOAT(NEVHEP)+0.5
      CALL HFILL(IOFF+20,BN,0.,STDXSEC)
      RETURN
      END
      SUBROUTINE TSTBKEM(IOFF)
C--- book histograms
C             IOFF =  0  --> HERWIG
C             IOFF = 20  --> JETSET
C             IOFF = 40  --> ISAJET
C             IOFF = 60  --> PYTHIA
C             IOFF = -1  --> all
C
      IMPLICIT NONE
C---   The HBOOK common
      REAL HMEMOR
      COMMON/PAWC/HMEMOR(100000)
      INTEGER IOFF
C---   Setup the HBOOK memory limit.
#ifdef HPZTST
      CALL HLIMIT(-100000)
#else
      CALL HLIMIT(100000)
#endif
C---   Book histograms.
      IF(IOFF.EQ.20) GOTO 100
      IF(IOFF.EQ.40) GOTO 200
      IF(IOFF.EQ.60) GOTO 300
      CALL HBOOK1(11,'HERWIG: NEVHEP',100,0.0,100.0,0.)
      CALL HBOOK1(12,'HERWIG: NHEP',100,0.,1000.,0.)
      CALL HBOOK1(13,'HERWIG: IDHEP',100,0.,100.,0.)
      CALL HBOOK1(14,'HERWIG: ISTHEP',100,0.,200.,0.)
      CALL HBOOK1(15,'HERWIG: JMOHEP(1,)',100,0.,1000.,0.)
      CALL HBOOK1(16,'HERWIG: JMOHEP(2,)',100,0.,1000.,0.)
      CALL HBOOK1(17,'HERWIG: JDAHEP(1,)',100,0.,1000.,0.)
      CALL HBOOK1(18,'HERWIG: JDAHEP(2,)',100,0.,1000.,0.)
#if !defined(HPZTST)
      CALL HBOOK1(20,'HERWIG: cross-section',100,0.,100.,0.)
#endif
      CALL HBOOK1(21,'HERWIG: PHEP(1,)',100,-100.,100.,0.)
      CALL HBOOK1(22,'HERWIG: PHEP(2,)',100,-100.,100.,0.)
      CALL HBOOK1(23,'HERWIG: PHEP(3,)',100,-1000.,1000.,0.)
      CALL HBOOK1(24,'HERWIG: PHEP(4,)',100,-1000.,1000.,0.)
      CALL HBOOK1(25,'HERWIG: PHEP(5,)',50,-250.,250.,0.)
      CALL HBOOK1(26,'HERWIG: VHEP(1,)',10,-1.,1.,0.)
      CALL HBOOK1(27,'HERWIG: VHEP(2,)',10,-1.,1.,0.)
      CALL HBOOK1(28,'HERWIG: VHEP(3,)',10,-1.,1.,0.)
      CALL HBOOK1(29,'HERWIG: VHEP(4,)',10,0.,1.,0.)
      IF(IOFF.GE.0) GOTO 400
 100  CALL HBOOK1(31,'JETSET: NEVHEP',100,0.,100.,0.)
      CALL HBOOK1(32,'JETSET: NHEP',100,0.,200.,0.)
      CALL HBOOK1(33,'JETSET: IDHEP',100,0.,100.,0.)
      CALL HBOOK1(34,'JETSET: ISTHEP',20,0.,20.,0.)
      CALL HBOOK1(35,'JETSET: JMOHEP(1,)',100,0.,100.,0.)
      CALL HBOOK1(36,'JETSET: JMOHEP(2,)',100,0.,100.,0.)
      CALL HBOOK1(37,'JETSET: JDAHEP(1,)',100,0.,100.,0.)
      CALL HBOOK1(38,'JETSET: JDAHEP(2,)',100,0.,100.,0.)
      CALL HBOOK1(41,'JETSET: PHEP(1,)',100,-100.,100.,0.)
      CALL HBOOK1(42,'JETSET: PHEP(2,)',100,-100.,100.,0.)
      CALL HBOOK1(43,'JETSET: PHEP(3,)',100,-100.,100.,0.)
      CALL HBOOK1(44,'JETSET: PHEP(4,)',100,-100.,100.,0.)
      CALL HBOOK1(45,'JETSET: PHEP(5,)',100,-100.,100.,0.)
      CALL HBOOK1(46,'JETSET: VHEP(1,)',100,-50.,50.,0.)
      CALL HBOOK1(47,'JETSET: VHEP(2,)',100,-50.,50.,0.)
      CALL HBOOK1(48,'JETSET: VHEP(3,)',100,-50.,50.,0.)
      CALL HBOOK1(49,'JETSET: VHEP(4,)',100,0.,100.,0.)
      IF(IOFF.GE.0) GOTO 400
 200  CALL HBOOK1(51,'ISAJET: NEVHEP',100,0.,100.,0.)
      CALL HBOOK1(52,'ISAJET: NHEP',100,0.,1000.,0.)
      CALL HBOOK1(53,'ISAJET: IDHEP',100,0.,100.,0.)
      CALL HBOOK1(54,'ISAJET: ISTHEP',50,0.,50.,0.)
      CALL HBOOK1(55,'ISAJET: JMOHEP(1,)',100,0.,1000.,0.)
      CALL HBOOK1(56,'ISAJET: JMOHEP(2,)',100,0.,1000.,0.)
      CALL HBOOK1(57,'ISAJET: JDAHEP(1,)',100,0.,1000.,0.)
      CALL HBOOK1(58,'ISAJET: JDAHEP(2,)',100,0.,1000.,0.)
#if !defined(HPZTST)
      CALL HBOOK1(60,'ISAJET: cross-section',100,0.,100.,0.)
#endif
      CALL HBOOK1(61,'ISAJET: PHEP(1,)',100,-500.,500.,0.)
      CALL HBOOK1(62,'ISAJET: PHEP(2,)',100,-500.,500.,0.)
      CALL HBOOK1(63,'ISAJET: PHEP(3,)',100,-500.,500.,0.)
      CALL HBOOK1(64,'ISAJET: PHEP(4,)',100,-500.,500.,0.)
      CALL HBOOK1(65,'ISAJET: PHEP(5,)',100,-500.,500.,0.)
      CALL HBOOK1(66,'ISAJET: VHEP(1,)',10,-1.,1.,0.)
      CALL HBOOK1(67,'ISAJET: VHEP(2,)',10,-1.,1.,0.)
      CALL HBOOK1(68,'ISAJET: VHEP(3,)',10,-1.,1.,0.)
      CALL HBOOK1(69,'ISAJET: VHEP(4,)',10,0.,1.,0.)
      IF(IOFF.GE.0) GOTO 400
 300  CONTINUE
#if !defined(HPZTST)
      CALL HBOOK1(71,'PYTHIA: NEVHEP',100,0.,100.,0.)
      CALL HBOOK1(72,'PYTHIA: NHEP',100,0.,1000.,0.)
      CALL HBOOK1(73,'PYTHIA: IDHEP',100,0.,100.,0.)
      CALL HBOOK1(74,'PYTHIA: ISTHEP',50,0.,50.,0.)
      CALL HBOOK1(75,'PYTHIA: JMOHEP(1,)',100,0.,1000.,0.)
      CALL HBOOK1(76,'PYTHIA: JMOHEP(2,)',100,0.,1000.,0.)
      CALL HBOOK1(77,'PYTHIA: JDAHEP(1,)',100,0.,1000.,0.)
      CALL HBOOK1(78,'PYTHIA: JDAHEP(2,)',100,0.,1000.,0.)
      CALL HBOOK1(80,'PYTHIA: cross-section',100,0.,100.,0.)
      CALL HBOOK1(81,'PYTHIA: PHEP(1,)',100,-500.,500.,0.)
      CALL HBOOK1(82,'PYTHIA: PHEP(2,)',100,-500.,500.,0.)
      CALL HBOOK1(83,'PYTHIA: PHEP(3,)',100,-500.,500.,0.)
      CALL HBOOK1(84,'PYTHIA: PHEP(4,)',100,-500.,500.,0.)
      CALL HBOOK1(85,'PYTHIA: PHEP(5,)',100,-500.,500.,0.)
      CALL HBOOK1(86,'PYTHIA: VHEP(1,)',10,-1.,1.,0.)
      CALL HBOOK1(87,'PYTHIA: VHEP(2,)',10,-1.,1.,0.)
      CALL HBOOK1(88,'PYTHIA: VHEP(3,)',10,-1.,1.,0.)
      CALL HBOOK1(89,'PYTHIA: VHEP(4,)',10,0.,1.,0.)
#endif
 400  CONTINUE
      RETURN
      END
