*
* $Id: jtbook.F,v 1.1.1.1 1996/01/11 14:14:39 mclareni Exp $
*
* $Log: jtbook.F,v $
* Revision 1.1.1.1  1996/01/11 14:14:39  mclareni
* Cojets
*
*
#include "cojets/pilot.h"
      SUBROUTINE JTBOOK(PX,PY,EPP,PSQ,IFLA)
C     *************************************
C-- BOOKS QUANTA GENERATED BY JETQCD
#if defined(CERNLIB_SINGLE)
      IMPLICIT REAL (A-H,O-Z)
#endif
#if defined(CERNLIB_DOUBLE)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
#endif
#include "cojets/cutoff.inc"
#include "cojets/event.inc"
#include "cojets/isjetc.inc"
#include "cojets/itapes.inc"
#include "cojets/m2qua.inc"
#include "cojets/maxn.inc"
#include "cojets/parqua.inc"
#include "cojets/quaor.inc"
C
      IFLAB=ABS(IFLA)
      EMP=(PSQ+PX**2+PY**2)/EPP
      PL=(EPP-EMP)*.5
      E=(EPP+EMP)*.5
      IF(E.LT.QZ.AND.(IFLAB.EQ.LGLU.OR.IFLAB.LE.3)) RETURN
      IF(NQUA+1.GE.MAXQUA) GO TO 500
      NQUA=NQUA+1
      IF(IFLA.EQ.LGLU) IFLA=0
      PARQUA(NQUA,1)=PX
      PARQUA(NQUA,2)=PY
      PARQUA(NQUA,3)=PL
      PARQUA(NQUA,4)=E
      PARQUA(NQUA,5)=SQRT(PSQ)
      PARQUA(NQUA,6)=IFLA
      PARQUA(NQUA,7)=IQUAOR
      CALL ROTQUA
      JETQUA(NQUA)=JETC
      RETURN
C
C-- ABNORMAL EXIT
500   N1=NEVENT+1
      WRITE(ITLIS,501) MAXQUA,N1
501   FORMAT(5(/),1X,31HNUMBER OF FINAL QUANTA EXCEEDS   ,I10
     1//1X,11HEVENT NO. =    ,I10
     3//1X,15HINCREASE MAXQUA         )
      CALL OVERDM
      RETURN
      END
