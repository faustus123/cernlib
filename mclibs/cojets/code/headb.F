*
* $Id: headb.F,v 1.1.1.1 1996/01/11 14:14:38 mclareni Exp $
*
* $Log: headb.F,v $
* Revision 1.1.1.1  1996/01/11 14:14:38  mclareni
* Cojets
*
*
#include "cojets/pilot.h"
      SUBROUTINE HEADB
C     ****************
C-- W/Z/GM EVENT PART OF HEADING
#if defined(CERNLIB_SINGLE)
      IMPLICIT REAL (A-H,O-Z)
#endif
#if defined(CERNLIB_DOUBLE)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
#endif
#include "cojets/alqgen.inc"
#include "cojets/bopar.inc"
#include "cojets/boson.inc"
#include "cojets/data1.inc"
#include "cojets/data2.inc"
#include "cojets/data3.inc"
#include "cojets/decpar.inc"
#include "cojets/eicht.inc"
#include "cojets/event.inc"
#include "cojets/evint.inc"
#include "cojets/evtype.inc"
#include "cojets/forcsl.inc"
#include "cojets/forgen.inc"
#include "cojets/fstate.inc"
#include "cojets/idrun.inc"
#include "cojets/iflghv.inc"
#include "cojets/intype.inc"
#include "cojets/itapes.inc"
#include "cojets/kfact.inc"
#include "cojets/nflav.inc"
#include "cojets/radlep.inc"
#include "cojets/total.inc"
#include "cojets/weakbo.inc"
#include "cojets/weakon.inc"
#include "cojets/zwpar.inc"
      CHARACTER*5 CH1(5),CH2(5)
      CHARACTER*2 WEAKCH,ZHCH,WHCH,DHCH
      DATA ZHCH,WHCH,DHCH/'Z ','W ','GM'/
      DATA ZH,WH/2.,3./,DH/4./
C
      IF(LEV(1).EQ.2) WEAKCH=ZHCH
      IF(LEV(1).EQ.3) WEAKCH=WHCH
      IF(LEV(1).EQ.4) WEAKCH=DHCH
      WRITE(ITLIS,25) WEAKCH
      SQBIM2=SQRT(BIM2)
      WRITE(ITLIS,21) ALAMB,PT2INT
      WRITE(ITLIS,71) QZEV,FACTK
C-- WEAKON, WIDTH
      IF(WEAKON.NE.DH) THEN
        IWZ=WEAKON
        WRITE(ITLIS,65) WEAKCH,PMAS(IWZ),DELTAR
        IF(MOPTWZ.EQ.0) THEN
          WRITE(ITLIS,63) WEAKCH
          IF(WIDTH.LT.1.E-3) WRITE(ITLIS,61) WEAKCH
          IF(WIDTH.GT.1.E-3) WRITE(ITLIS,62) WEAKCH,WIDTH
        ELSE
          WRITE(ITLIS,64) WEAKCH,WEAKCH,WIDTH
        ENDIF
      ENDIF
C-- DECAY
      IF(IFDC.LT.0) WRITE(ITLIS,28) WEAKCH
      IF(IFDC.EQ.0) WRITE(ITLIS,15) WEAKCH
      IF(IFDC.GT.0.AND.WEAKON.NE.DH)
     *WRITE(ITLIS,29) WEAKCH,LFINV(1)
      IF(IFDC.GT.0.AND.WEAKON.EQ.DH)
     *WRITE(ITLIS,30) WEAKCH,LFINV(1)
      IF(IFDC.LE.0) GO TO 14
      ICHDB=IFDC
      IF(WEAKON.NE.WH) THEN
        CALL CHDEC(2,ICHDB,CH1)
        WRITE(ITLIS,31) WEAKCH,(CH1(J),J=1,2)
      ELSE
        CALL CHDEC(3,ICHDB,CH1)
        CALL CHDEC(4,ICHDB,CH2)
        WRITE(ITLIS,36) (CH1(J),J=1,2),(CH2(J),J=1,2)
      ENDIF
14    CONTINUE
C-- X-SECTION
      IF(NEVENT.EQ.0) THEN
        SIG=0.
        WRITE(ITLIS,102)
        GO TO 101
      ENDIF
      SIG=FXSCT*FLOAT(NEVENB)/FLOAT(NGEX)*FACTK
      IF(INTYPE.EQ.1) SIG=SIG*FLOAT(IEVT)/FLOAT(NEVENB)
      IF(WEAKON.NE.DH) THEN
        IF(IFDC.GT.0) THEN
          IF(MOPTWZ.EQ.0) THEN
            BR=CBR(IFDC)
            IF(IFDC.NE.1.AND.IFDC.NE.13) BR=BR-CBR(IFDC-1)
            SIG=SIG*BR
          ENDIF
          IF(LFORSL.NE.0) SIG=SIG*BRXFSL**NFORSL
          WRITE(ITLIS,27) WEAKCH,SIG
          IF(MOPTWZ.EQ.0) THEN
            WRITE(ITLIS,81) WEAKCH,BR
          ELSE
            WRITE(ITLIS,84) WEAKCH
          ENDIF
          IF(LFORSL.NE.0) WRITE(ITLIS,82) CHA4(KFORSL,1)
        ELSE
          WRITE(ITLIS,27) WEAKCH,SIG
        ENDIF
      ELSE
        IF(MOPTWZ.EQ.0) WRITE(ITLIS,66)
        IF(MOPTWZ.EQ.1) WRITE(ITLIS,67)
          WRITE(ITLIS,60) SIG,BOMSMN,BOMSMX
      ENDIF
      IF(INTYPE.EQ.1) THEN
        NRJTP=NEVENB-IEVT
        WRITE(ITLIS,85) NRJTP
      ENDIF
      WRITE(ITLIS,83) FACTK
101   CONTINUE
      IF(INTYPE.EQ.0) THEN
        WRITE(ITLIS,16) NEVENT
      ELSE IF(INTYPE.EQ.1) THEN
        WRITE(ITLIS,16) IEVT
      ENDIF
      NEVNTS=NEVENT
      SIGTOT=SIG
C-- QED RADIATION IN LEPTONIC DECAY MODES
      IF(WEAKON.EQ.ZH.AND.IFDC.GT.3.OR.
     *   WEAKON.EQ.WH.AND.IFDC.GT.15) GO TO 80
      IF(IFDC.NE.0.AND.IRADLP.EQ.0) WRITE(ITLIS,75)
      IF(IFDC.NE.0.AND.IRADLP.EQ.1) WRITE(ITLIS,76)
      IF(IFDC.NE.0.AND.IRADLP.EQ.2) WRITE(ITLIS,77)
80    CONTINUE
C-- OTHER
      WRITE(ITLIS,74) NFLAV
      IF((WEAKON.EQ.ZH.AND.IFDC.EQ.12).OR.(WEAKON.EQ.WH.AND.IFDC.EQ
     *.18)) WRITE(ITLIS,11) QMAS(6)
      IF(WEAKON.NE.DH.AND.IFDC.LT.0) WRITE(ITLIS,11) QMAS(6)
      IF(KMPSCA.GT.1) WRITE(ITLIS,33) KMPSCA,WEAKCH,PTMGE
      IF(IEICHT.EQ.0) WRITE(ITLIS,72)
      IF(IEICHT.GE.1.AND.IEICHT.LE.2) WRITE(ITLIS,73) IEICHT
C
25    FORMAT(T2,1H*,10X,A2,11H-PRODUCTION  ,T121,1H*/T2,1H*,T121,1H*)
21    FORMAT(T2,1H*,3X,8HLAMBDA =,E10.3,4H GEV
     *,5X,13HMEAN KT**2 = ,E10.3,7H GEV**2,
     *T121,1H*
     */T2,1H*,T121,1H*)
71    FORMAT(T2,1H*,3X,8HQZEV   = ,E10.3,4H GEV,5X,11HK FACTOR = ,E10.3
     *,T121,1H*/T2,1H*,T121,1H*)
61    FORMAT(T2,1H*,3X,A1,1X,30HMASS GENERATED WITH ZERO WIDTH   ,
     1T121,1H*/T2,1H*,T121,1H*)
62    FORMAT(T2,1H*,3X,A1,1X,
     1'(DECAY) MASS GENERATED WITH B.W. SPECTRUM OF WIDTH =  ',
     2E10.3,6H (GEV),T121,1H*/T2,1H*,T121,1H*)
63    FORMAT(T2,1H*,3X,A1,1X,
     1'PRODUCED WITH OPTION 0 (PRODUCTION WITHOUT BREIT-WIGNER)'
     2,T121,1H*/T2,1H*,T121,1H*)
64    FORMAT(T2,1H*,3X,A1,1X,
     1'PRODUCED WITH OPTION 1 (PRODUCTION WITH BREIT-WIGNER)'
     2,T121,1H*/T2,1H*,T121,1H*
     3/T2,1H*,3X,A1,1X,'WIDTH = ',E10.3,6H (GEV)
     4,T121,1H*/T2,1H*,T121,1H*)
65    FORMAT(T2,1H*,3X,A1,1X,'MASS = ',E10.3,6H (GEV)
     *,'   (DELTAR =',E11.4,')'
     1,T121,1H*/T2,1H*,T121,1H*)
66    FORMAT(T2,1H*,3X,'PRODUCTION WITH OPTION 0 (NO GM-Z INTERFERENCE)'
     4,T121,1H*/T2,1H*,T121,1H*)
67    FORMAT(T2,1H*,3X
     3,'PRODUCTION WITH OPTION 1 (WITH GM-Z INTERFERENCE)'
     4,T121,1H*/T2,1H*,T121,1H*)
27    FORMAT(T2,1H*,3X,
     *A2,1X,'X-SECTION =',E10.3,' (MB)'
     *,T121,1H*/T2,1H*,T121,1H*)
81    FORMAT(T2,1H*,3X,
     *'   ***X-SECTION VALUE INCLUDES BR OF FORCED ',A2,' DECAY CHANNEL'
     *,' (BR =',E10.3,')'
     *,T121,1H*/T2,1H*,T121,1H*)
82    FORMAT(T2,1H*,3X,
     *'   ***X-SECTION VALUE INCLUDES THE EFFECTS OF SEMILEPTONIC DECAY'
     *,' FORCING OF QUARK ',A2
     *,T121,1H*/T2,1H*,T121,1H*)
83    FORMAT(T2,1H*,3X,
     *'   ***X-SECTION VALUE INCLUDES K-FACTOR =',E10.3
     *,T121,1H*/T2,1H*,T121,1H*)
84    FORMAT(T2,1H*,3X,
     *'   ***X-SECTION VALUE INCLUDES BR OF FORCED ',A2,' DECAY CHANNEL'
     *,' (BR VARYING OVER BREIT-WIGNER)'
     *,T121,1H*/T2,1H*,T121,1H*)
85    FORMAT(T2,1H*,3X,
     *'   ***X-SECTION VALUE INCLUDES EFFECTS FROM EDIT SELECTIONS'
     *,' WHEN WRITING TO TAPE - REJECTED EVENTS =',I10
     *,T121,1H*/T2,1H*,T121,1H*)
60    FORMAT(T2,1H*,3X,'DRELL-YAN X-SECTION = ' ,
     1E10.3,' (MB)','   FOR ',E10.3,' < DILEPTON MASS (GEV) < '
     1,E10.3,
     2T121,1H*/T2,1H*,T121,1H*)
28    FORMAT(T2,1H*,3X,A2,1X,20HDECAY CHANNEL RANDOM,T121,1H*
     */T2,1H*,T121,1H*)
29    FORMAT(T2,1H*,3X,A2,1X,24HDECAY CHANNEL FORCED NO.  ,I3,T121,1H*
     */T2,1H*,T121,1H*)
30    FORMAT(T2,1H*,3X,A2,1X,23HDECAY CHANNEL REQUESTED   ,I3,T121,1H*
     */T2,1H*,T121,1H*)
31    FORMAT(T2,1H*,3X,1H(,A2,10H   ---+   ,A4,2X,A4,1H),T121,1H*
     */T2,1H*,T121,1H*)
36    FORMAT(T2,1H*,3X,13H(W+   ---+   ,A4,2X,A4,9H   AND   ,
     *12HW-   ---+     ,A4,2X,A4,1H),T121,1H*/T2,1H*,T121,1H*)
75    FORMAT(T2,1H*,3X,'QED RAD. EFFECTS IN LEPT. DECAYS OF INT. BOSON'
     *,' ARE NEGLECTED'
     *,T121,1H*/T2,1H*,T121,1H*)
76    FORMAT(T2,1H*,3X,'QED RAD. EFFECTS IN LEPT. DECAYS OF INT. BOSON'
     *,' ARE CALCULATED AT O(ALPHA) + LPA'
     *,T121,1H*/T2,1H*,T121,1H*)
77    FORMAT(T2,1H*,3X,'QED RAD. EFFECTS IN LEPT. DECAYS OF INT. BOSON'
     *,' ARE CALCULATED AT O(ALPHA)'
     *,T121,1H*/T2,1H*,T121,1H*)
74    FORMAT(T2,1H*,3X,'NO. OF QUARK FLAVORS =',I3
     *,T121,1H*/T2,1H*,T121,1H*)
11    FORMAT(T2,1H*,3X,16HTOP QUARK MASS = ,E10.3,6H (GEV),T121,1H*
     */T2,1H*,T121,1H*)
15    FORMAT(T2,1H*,3X,A2,1X,25HBOSON REQUESTED UNDECAYED
     *,T121,1H*/T2,1H*,T121,1H*)
33    FORMAT(T2,1H*,3X,'FORCED ',I3,' PARTON COLLISIONS -- ONE '
     *,'YIELDING ',A2,', THE OTHERS JET PRODUCTION',T121,1H*/
     *T2,1H*,13X,'FOR JET-YIELDING PARTON COLLISIONS GENERATION '
     *,'IS FORCED OVER PT(HARD SCATTERING) .GT. ',E10.3
     *,' (GEV)',T121,1H*)
72    FORMAT(T2,1H*,3X,'NA3 STRUCTURE FUNCTIONS USED'
     *,T121,1H*/T2,1H*,T121,1H*)
73    FORMAT(T2,1H*,3X,'EICHTEN ET AL. STRUCTURE FUNCTIONS SET ',I1
     *,' USED'
     *,T121,1H*/T2,1H*,T121,1H*)
16    FORMAT(T2,1H*,3X,19HTOTAL NO. OF EVENTS ,I10,T121,1H*
     */T2,1H*,T121,1H*)
102   FORMAT(T2,1H*,3X,'***NO EVENTS GENERATED***'
     *,T121,1H*/T2,1H*,T121,1H*)
C
      RETURN
      END
