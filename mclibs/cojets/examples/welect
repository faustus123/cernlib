*
* $Id: welect,v 1.1.1.1 1996/01/11 14:15:07 mclareni Exp $
*
* $Log: welect,v $
* Revision 1.1.1.1  1996/01/11 14:15:07  mclareni
* Cojets
*
*
* This directory was created from cojets.car patch welect
#ifndef CERNLIB_COJCONV
#define CERNLIB_COJCONV
#endif
+ADD,COJCONV,MAIN,38
C-
C-
C- SET UP FOR W --> E + NU
C-
      ITDKY=1
      ITLIS=6
      NLEAVE=10
      IEVTYP=3
      ECM=630.
      NFLAV=6
      ALAMB=0.2
      IEICHT=1
C- INPUT PARAMETERS FOR W PRODUCTION AND DECAY
      IDECBO=1
C-
C- STOP DECAYS OF PI0 AND K0S
      CALL STOPD(110)
      CALL STOPD(20)
C-
C-
+ADD,COJCONV,BOOKH,9
C-
C-
C- SET UP FOR W --> E + NU
C-
      COMMON//B(10000)
      CALL HLIMIT(10000)
      CALL HOUTPU(ITLIS)
      CALL HERMES(ITLIS)
C-
C-- BOOK HISTOGRAMS
      CALL HBOOK1(11,'ETL W-BOT.$',100,0.,100.)
      CALL HBOOK1(13,'Y*CH ELECTRON$',100,-5.,5.)
      CALL HBOOK2(12,'EL PT/Y$',100,-5.,5.,50,0.,50.)
C-
C-
+ADD,COJCONV,FILLH,15
C-
C-
C- SET UP FOR W --> E + NU
C-
      COMMON/CUTS/ETLC
      DATA ICALL/0/
C
      IF(ICALL.GT.0) GO TO 10
      ICALL=1
      ETLC=0.
10    CONTINUE
C
      IF(NPART.EQ.0) RETURN
      DO 1 IPART=1,NPART
C- SELECT ELECTRON/POSITRON
      ITYPE=INT(PARHAD(IPART,6))
      IF(ITYPE.NE.7.AND.ITYPE.NE.8) GO TO 1
      ETL=SQRT(PARHAD(IPART,1)**2+PARHAD(IPART,2)**2)
      IF(ETL.LT.ETLC) GO TO 1
      CALL HFILL(11,ETL,0.,1.)
      Y=SIGN(-LOG(TAN(ATAN(ETL/ABS(PARHAD(IPART,3)))/2.))
     $,PARHAD(IPART,3))*CHARGE(IDENT(IPART))
      CALL HFILL(13,Y,0.,1.)
      CALL HFILL(12,Y,ETL,1.)
1     CONTINUE
C-
C-
+ADD,COJCONV,OUTH,10
C-
C-
C- SET UP FOR W --> E + NU
C-
      COMMON/CUTS/ETLC
C
      IF(NEVNTS.EQ.0) RETURN
      FACT=SIGTOT/FLOAT(NEVNTS)
      CALL HOPERA(11,'+',11,11,FACT,0.)
C
      WRITE(ITLIS,5) ETLC
5     FORMAT(/////1X,54(1H=)/1X,'ELECTRONS FROM W --> E + NU'
     1,5X,6HETLC =,E12.3,' GEV'/1X,54(1H=)/////)
C
      CALL HISTDO
C-
C-
